<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">

      <title>Title</title>

      <!-- Bootstrap -->
      <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" type="text/css" rel="stylesheet">

      <!-- stylesheet isn't working (MIME type???) -->
      <!-- <link type="text/css" href="css/style.css" rel="stylesheet"> -->
      <style>
          #num_likes, #submit {
              margin-top: 0px;
          }

          #num_likes, #username {
              width: 80%;
          }

          #header {
              background-color: #cee5ff
          }

          a:link {
              color: black;
          }

          a:hover {
              text-decoration: none;
          }

          /* All div elements (tweets) that are children of id #tweets-body */
          #tweets-body > a > div {
              background-color: #f2f2f2;
              padding: 10px;
              width: 50%;
              margin-top: 15px;
              border-radius: 8px;
          }
      </style>
</head>
<body>

    <div class="jumbotron text-center" id="header">
        <h1>My Best Tweets</h1>
        <h4>Enter your Twitter username and an amount of likes to filter your tweets by!</h4>
    </div>

    <div class="container" id="inputs-body">
        <div class="row">
            <div class="col-md-5">
                <input id="username" type="text" placeholder="Username" class="form-control">
            </div>
            <div class="col-md-5">
                <input id="num_likes" type="number" placeholder="Tweet Likes" class="form-control">
            </div>
            <div class="col-md-2">
                <button type="button" class="btn btn-primary" id="submit" onclick="getTweets()">Get Tweets</button>
            </div>
        </div>
    </div>

    <div class="container" id="tweets-body">

    </div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>

    <script>
          var socket = io();

          function getTweets() {
              $("#tweets-body").html("");

              var user = document.getElementById('username').value;
              var num_likes = document.getElementById('num_likes').value;

              if (user.length > 0) {
                  socket.emit('request', {user: user, num_likes: num_likes});
              } else {
                  alert("Please enter a valid username!");
              }
          }

          // TODO: make tweets clickable w/ link to tweet
          // TODO: Give option of likes and/or retweets
          socket.on('sendTweet', function(data) {
              var link = "https://twitter.com/" + data.user + "/status/" + data.id;
              var newTweet = "<a href=" + link + ">"
              + "<div class='container'>"
              + "<h5>" + data.tweet + "</h5>"
              + "</div>"
              + "</a>";
              $("#tweets-body").append(newTweet);
          })
    </script>

</body>
</html>
