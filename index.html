<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">

      <title>Title</title>

      <!-- Bootstrap -->
      <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" type="text/css" rel="stylesheet">

      <!-- stylesheet isn't working (MIME type???) -->
      <!-- <link type="text/css" href="css/style.css" rel="stylesheet"> -->
      <style>
          body {
              padding-bottom: 30px;
          }

          #num_likes, #submit {
              margin-top: 0px;
          }

          #submit {
              width: 100%;
          }

          #header {
              background-color: #cee5ff
          }

          a:link {
              color: black;
          }

          a:hover {
              text-decoration: none;
          }

          /* All div elements (tweets) that are children of id #tweets-body */
          #main-body div > div > a > div {
              background-color: #f2f2f2;
              padding: 10px;
              margin-top: 15px;
              border-radius: 8px;
          }

          .center {
              margin: auto;
              padding-top: 15px;
          }
      </style>
</head>
<body>

    <div class="jumbotron text-center" id="header">
        <h1>My Best Tweets</h1>
        <h4>Enter your Twitter username and an amount of likes to filter your tweets by!</h4>
    </div>

    <div class="container" id="input-body">
        <div class="row">
            <div class="col-md-6" id="tweets_col">
                <input id="username" type="text" placeholder="Username" class="form-control">
            </div>
            <div class="col-md-2" id="likes_col">
                <input id="num_likes" type="number" placeholder="# Likes" class="form-control">
            </div>
            <div class="col-md-2" id="retweets_col">
                <input id="num_retweets" type="number" placeholder="# Retweets" class="form-control">
            </div>
            <div class="col-md-2" id="get_tweets">
                <button type="button" class="btn btn-primary block" id="submit" onclick="getTweets()">Get Tweets</button>
            </div>
        </div>
    </div>

    <div class="container" id="main-body">

    </div>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>

    <script>
          var socket = io();

          function getTweets() {
              $("#main-body").html("");

              var user = document.getElementById('username').value;
              var num_likes = document.getElementById('num_likes').value;
              var num_retweets = document.getElementById('num_retweets').value;

              if (user.length > 0) {
                  socket.emit('request', {user: user,
                                     num_likes: num_likes,
                                  num_retweets: num_retweets});
              } else {
                  alert("Please enter a valid username!");
              }
          }

          // TODO: Give option of likes and/or retweets
          socket.on('sendTweet', function(data) {
              var link = "https://twitter.com/" + data.user + "/status/" + data.id;
              var newTweet = "<a href=" + link + ">"
              + "<div class='container'>"
              + "<h5>" + data.tweet + "</h5>"
              + "</div>"
              + "</a>"

              var newRow = "<div class='row'>"
              + "<div class='col-md-6'>"
              + newTweet
              + "</div>"
              + "<div class='col-md-2 text-center center'>"
              + "<h5>" + data.likes + "</h5>"
              + "</div>"
              + "<div class='col-md-2 text-center center'>"
              + "<h5>" + data.retweets + "</h5>"
              + "</div>"
              + "<div class='col-md-2 text-center center'>"
              + "<h5>" + data.date.substring(0, 11) + "</h5>"
              + "</div>"
              + "</div>";
              $("#main-body").append(newRow);
          })
    </script>

</body>
</html>
